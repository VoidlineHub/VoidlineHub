-- [[ 1. BYPASS SECTION ]] --
-- Ditaruh paling atas agar Adonis lumpuh sebelum UI & Script lain jalan
local function SilentBypass()
    local function neutralizeAdonis()
        for _, v in pairs(getgc(true)) do
            if type(v) == "function" and islclosure(v) then
                local ups = debug.getupvalues(v)
                for i, up in pairs(ups) do
                    if type(up) == "function" then
                        local upInfo = debug.getinfo(up)
                        -- Mematikan fungsi pelaporan "Detected"
                        if upInfo.name == "v_u_39" or upInfo.name == "Detected" then
                            debug.setupvalue(v, i, function(...) 
                                warn("üõ°Ô∏è [Silent] Adonis detection attempt blocked!")
                                return 
                            end)
                        end
                    end
                end
            end
        end
    end
    pcall(neutralizeAdonis)

    -- SPRINT PROTECTOR (Agar laporan Namecall/Remote tidak tembus)
    local oldRemote
    oldRemote = hookfunction(Instance.new("RemoteEvent").FireServer, function(self, ...) 
        local args = {...}
        if args[1] == "Detected" or args[1] == "Kick" or args[1] == "BadMemes" then
            return nil
        end
        return oldRemote(self, ...)
    end)
    print("‚úÖ Bypass Active & Silent.")
end
pcall(SilentBypass)

task.wait(0.5) -- Jeda agar bypass terpasang sempurna

-- [[ 2. UI / WINDOWS SECTION ]] --
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local LP = Players.LocalPlayer
local PlayerGui = LP:WaitForChild("PlayerGui")

-- // WindUI Initialization
local WindUI
do
local ok, result = pcall(function()
return require("./src/Init")
end)
if ok then WindUI = result else
WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/Footagesus/WindUI/main/dist/main.lua"))()
end
end

-- // Global Variables
_G.AutoFarmBarista = false
_G.AutoFarmCourier = false
_G.WebhookURL = ""
_G.WebhookEnabled = true
_G.AntiAFK = false
_G.HideNameEnabled = false
_G.HideCharEnabled = false
_G.AutoRejoin = false


--// STATE
local StartTime = nil
local TotalEarned = 0
local LastMoney = 0
local SelectedJob = "Civilian"

local WEBHOOK_INTERVAL = 50

local function FormatRupiah(num)
local s = tostring(num)
local result = s:reverse():gsub("(%d%d%d)", "%1."):reverse()
if result:sub(1,1) == "." then
result = result:sub(2)
end
return "Rp" .. result
end

--// CONFIG
_G.WebhookURL = _G.WebhookURL or ""

--// PLAYER DATA (NON LEADERSTATS)
local PlayerData = LP:WaitForChild("PlayerData")
local MoneyValue = PlayerData:WaitForChild("RPValue")

LastMoney = MoneyValue.Value
MoneyValue:GetPropertyChangedSignal("Value"):Connect(function()
local diff = MoneyValue.Value - LastMoney
if diff > 0 then
TotalEarned += diff
end
LastMoney = MoneyValue.Value
end)

--// FORMAT TIME
local function EnsureStartTime()
if not StartTime then
StartTime = os.time()
end
end

local function FormatTime(sec)
return string.format(
"%02d:%02d:%02d",
math.floor(sec / 3600),
math.floor((sec % 3600) / 60),
sec % 60
)
end

--// WEBHOOK FUNCTION
local function SendWebhook(isTest)
if _G.WebhookURL == "" or not _G.WebhookURL:find("https://discord.com/api/webhooks/") then
return
end

if not isTest and not _G.WebhookEnabled then
return
end

local payload

if isTest then
payload = {
username = "VoidlineHub",
avatar_url = "https://cdn.discordapp.com/attachments/1464981605486694695/1466048679239487705/IMG_20260125_124614.jpg",
embeds = {{
title = "‚úÖ Webhook Test Successful",
description = "webhook successfully ready to use.",
color = 5763719,
thumbnail = {
url = "https://cdn.discordapp.com/attachments/1464981605486694695/1466048679239487705/IMG_20260125_124614.jpg"
}
}}
}
else
EnsureStartTime()

local runtimeSec = os.time() - StartTime
local estPerHour = runtimeSec > 0 and math.floor((TotalEarned / runtimeSec) * 3600) or 0

payload = {
username = "VoidlineHub",
avatar_url = "https://cdn.discordapp.com/attachments/1464981605486694695/1466048679239487705/IMG_20260125_124614.jpg",
embeds = {{
title = "üìå Jobs Data Report",
color = 2067276,
thumbnail = {
url = "https://cdn.discordapp.com/attachments/1464981605486694695/1466048679239487705/IMG_20260125_124614.jpg"
},
fields = {
{
name = "üß∞ Job Select",
value = "" .. (       _G.AutoFarmBarista and "Barista"       or _G.AutoFarmCourier and "Courier"       or "Idle"       ) .. "",
inline = false
},
{
name = "‚è± Running Time",
value = "" .. FormatTime(runtimeSec) .. "",
inline = true
},
{
name = "üí∞ Total Earning",
value = "" .. FormatRupiah(TotalEarned) .. "",
inline = true
},
{
name = "üìà Est. Income / Hour",
value = "" .. FormatRupiah(estPerHour) .. "",
inline = true
},
{
name = "üíµ Current Money",
value = "" .. FormatRupiah(MoneyValue.Value) .. "",
inline = false
}
},
footer = { text = "VoidlineHub System" },
timestamp = os.date("!%Y-%m-%dT%H:%M:%SZ")
}}
}

end

local req = syn and syn.request or http_request or request
if req then
req({
Url = _G.WebhookURL,
Method = "POST",
Headers = { ["Content-Type"] = "application/json" },
Body = HttpService:JSONEncode(payload)
})
end

end

--// REALTIME LOOP (ANTI SPAM)
task.spawn(function()
while task.wait(WEBHOOK_INTERVAL) do
SendWebhook(false)
end
end)

-- // Window
local Window = WindUI:CreateWindow({
Title = "VoidlineHub | free version.",
Folder = "adadeh",
Icon = "rbxassetid://124846601689213",
NewElements = true,
Size = UDim2.fromOffset(300, 350),
OpenButton = { Title = "VoidlineHub", Enabled = true, Draggable = true, Color = ColorSequence.new(Color3.fromHex("#30FF6A"), Color3.fromHex("#e7ff2f")) },
Topbar = { Height = 44, ButtonsType = "Mac" },
})

-- // TAB: HOME
local HomeTab = Window:Tab({ Title = "Home", Icon = "house" })

HomeTab:Section({ Title = "Update Log" })
HomeTab:Button({
Title = "Version 1.0",
Desc = "[+]added new autofarm\n[+]added barista\n[+]webhook sistem\n[+]new ui",
Icon = "file-text"
})

HomeTab:Section({ Title = "Game Information" })
local GameTime = HomeTab:Button({
Title = "Job Status",
Desc = "Preparing...",
Icon = "activity"
})
local function SetGameStatus(text)
if GameTime and GameTime.Set then
GameTime:Set({ Desc = text })
end
end
local FpsLabel = HomeTab:Button({ Title = "Fps", Desc = "0 FPS", Icon = "monitor" })
local PingLabel = HomeTab:Button({ Title = "Ping", Desc = "Calculating...", Icon = "signal" })
local CurrentMoney = HomeTab:Button({ Title = "current money", Desc = "Calculating...", Icon = "wallet" })

-- // SOCIAL LINKS
HomeTab:Section({ Title = "Social Links" })
HomeTab:Paragraph({ Title = "Discord Server", Desc = "Join community for updates." })
HomeTab:Button({
Title = "Copy Link",
Icon = "link",
Justify = "Center",
Callback = function()
setclipboard("https://discord.gg/5zHKMnA7KC")
WindUI:Notify({ Title = "Discord", Content = "Link copied!" })
end
})

HomeTab:Space()

HomeTab:Paragraph({ Title = "Tiktok Media", Desc = "Follow our Tiktok!" })
HomeTab:Button({
Title = "Copy Link",
Justify = "Center",
Callback = function()
setclipboard("tiktok.com/@billzzhub")
WindUI:Notify({ Title = "Tiktok", Content = "Link copied!" })
end
})

HomeTab:Section({ Title = "Current Status" })
HomeTab:Paragraph({
Title = "Activities",
Desc = "Barista: Waiting\nPolice: Waiting\nPause: Enabled"
})

local AutoFarmTab = Window:Tab({ Title = "Auto Farm", Icon = "car" })
AutoFarmTab:Section({ Title = "Barista" })
AutoFarmTab:Toggle({
Title = "Auto Farm Barista",
Value = false,
Callback = function(v)
_G.AutoFarmBarista = v
end
})
AutoFarmTab:Section({ Title = "Courier" })
AutoFarmTab:Toggle({ Title = "Autofarm courier", Locked = true, LockedTitle = "Soon" })
AutoFarmTab:Section({ Title = "Police" })
AutoFarmTab:Toggle({ Title = "Autofarm Police", Locked = true, LockedTitle = "Only Premium" })

local TeleportTab = Window:Tab({ Title = "Teleport", Icon = "map" })
TeleportTab:Section({ Title = "Teleport Dealer" })

-- =========================
-- VOID TWEEN TELEPORT (DEALER)
-- =========================
local function getHRP()
local char = LP.Character or LP.CharacterAdded:Wait()
return char:WaitForChild("HumanoidRootPart")
end

local function VoidTweenTo(targetCF)
local hrp = getHRP()
local VOID_Y = -30
local SPEED = 180

-- turun ke void
local downTween = TweenService:Create(
hrp,
TweenInfo.new(0.5, Enum.EasingStyle.Sine),
{ CFrame = hrp.CFrame * CFrame.new(0, VOID_Y, 0) }
)
downTween:Play()
downTween.Completed:Wait()

-- jalan horizontal di void
local targetVoid = CFrame.new(targetCF.X, VOID_Y, targetCF.Z)
local dist = (hrp.Position - targetVoid.Position).Magnitude

local moveTween = TweenService:Create(
hrp,
TweenInfo.new(dist / SPEED, Enum.EasingStyle.Linear),
{ CFrame = targetVoid }
)
moveTween:Play()
moveTween.Completed:Wait()

-- naik ke permukaan
TweenService:Create(
hrp,
TweenInfo.new(0.5, Enum.EasingStyle.Sine),
{ CFrame = targetCF + Vector3.new(0, 2, 0) }
):Play()

end

local Locations = {
["Luxury"] = CFrame.new(-4810, 6, -771),
["Sizuki"] = CFrame.new(-4819, 6, -771),
["Yahamax"] = CFrame.new(709, 4, -736),
["Police"] = CFrame.new(2823, 5, -829),
["Trucks"] = CFrame.new(-10248, 7, 1304),
["Cars"] = CFrame.new(-6605, 5, -4211),
["DragSpec"] = CFrame.new(-5005, 4, -5351),
["Vespero"] = CFrame.new(-5753, 6, -3896),
["Hando"] = CFrame.new(-5956, 6, -3898)
}

TeleportTab:Dropdown({
Title = "Select Dealer",
Values = {"Luxury","Sizuki","Yahamax","Police","Trucks","Cars","DragSpec","Vespero","Hando"},
Callback = function(v)
_G.SelectTp = v
end
})

TeleportTab:Button({
Title = "Teleport",
Callback = function()
if _G.SelectTp and Locations[_G.SelectTp] then
VoidTweenTo(Locations[_G.SelectTp])
end
end
})

local VehicleTab = Window:Tab({ Title = "Vehicle", Icon = "car-front",  })
VehicleTab:Section({ Title = "Vehicle Config" })
VehicleTab:Input({ Title = "Max Force", Locked = true, LockedTitle = "Premium Only" })
VehicleTab:Input({ Title = "Increment", Locked = true, LockedTitle = "Premium Only" })
VehicleTab:Input({ Title = "Interval", Locked = true, LockedTitle = "Premium Only" })
VehicleTab:Section({ Title = "enable Config" })
VehicleTab:Toggle({ Title = "Enable Boost", Locked = true, LockedTitle = "Premium Only" })

VehicleTab:Toggle({ Title = "straight boost", Locked = true, LockedTitle = "Only Premium" })

local SettingTab = Window:Tab({ Title = "Settings", Icon = "settings" })

SettingTab:Section({ Title = "Character & UI" })

SettingTab:Toggle({
Title = "Hide Name",
Callback = function(v)
_G.HideNameEnabled = v
end
})

SettingTab:Toggle({
Title = "Hide Character",
Callback = function(v)
_G.HideCharEnabled = v
end
})

SettingTab:Button({
Title = "Reset Character",
Callback = function()
if LP.Character then
LP.Character:BreakJoints()
end
end
})

SettingTab:Section({ Title = "Automation" })

SettingTab:Toggle({
Title = "Auto Rejoin",
Value = true,
Callback = function(v)
_G.AutoRejoin = v
end
})

SettingTab:Toggle({
Title = "Anti AFK",
Value = true,
Callback = function(v)
_G.AntiAFK = v
end
})

SettingTab:Section({ Title = "Webhook Log" })
SettingTab:Input({ Title = "Webhook URL", Callback = function(v) _G.WebhookURL = v end })
SettingTab:Toggle({ Title = "Enable Webhook Log", Callback = function(v) _G.WebhookEnabled = v end })
SettingTab:Button({ Title = "Test Send Webhook", Callback = function() SendWebhook(true) end })

-- // LOGIC BARISTA
-- =========================
-- SERVICES
-- =========================
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local LP = Players.LocalPlayer
local PlayerGui = LP:WaitForChild("PlayerGui")

-- =========================
-- PATHS & REMOTES
-- =========================
local BaristaJob = workspace:WaitForChild("BaristaJob")
local Interactions = BaristaJob:WaitForChild("Interactions")
local JobEvents = ReplicatedStorage:WaitForChild("JobEvents")
local TeamChangeRequest = JobEvents:WaitForChild("TeamChangeRequest")

local BaristaAssets = ReplicatedStorage:WaitForChild("BaristaAssets")
local BaristaEvent = BaristaAssets:WaitForChild("Events"):WaitForChild("BaristaEvent")

local startPart = Interactions.StartPart.StartPart
local machinePart = Interactions.MachinePart.MachinePart
local registerPart = Interactions.RegisterPart.RegisterPart
local supplyPart = Interactions.SupplyPart.SupplyPart
local supplyPos = Vector3.new(-5116.784, 5.789, -670.858)

-- =========================
-- STATE & GLOBALS
-- =========================
_G.AutoFarmBarista = _G.AutoFarmBarista or false
local BaristaRunning = false
local isWorking = false

-- =========================
-- HELPERS
-- =========================
local function getHRP()
    return LP.Character and LP.Character:FindFirstChild("HumanoidRootPart")
end

-- VOID TWEEN ENGINE
local function voidTween(targetCF)
    local hrp = getHRP()
    if not hrp then return end
    local voidHeight = -30

    local downCF = hrp.CFrame * CFrame.new(0, voidHeight, 0)
    TweenService:Create(hrp, TweenInfo.new(0.5), {CFrame = downCF}):Play()
    task.wait(0.6)

    local targetVoidCF = CFrame.new(targetCF.X, targetCF.Y + voidHeight, targetCF.Z)
    local dist = (hrp.Position - targetVoidCF.Position).Magnitude
    local moveTween = TweenService:Create(
        hrp,
        TweenInfo.new(dist / 180, Enum.EasingStyle.Linear),
        {CFrame = targetVoidCF}
    )
    moveTween:Play()
    moveTween.Completed:Wait()

    TweenService:Create(
        hrp,
        TweenInfo.new(0.5),
        {CFrame = targetCF + Vector3.new(0, 2, 0)}
    ):Play()
    task.wait(0.6)
end

-- Normal Click untuk Register/Minigame (Sesuai Permintaan)
local function smartWaitAndClick(prompt)
    if not prompt then return end
    local t = 0
    while (not prompt.Enabled or not prompt.Parent) and t < 50 do
        task.wait(0.1)
        t += 1
    end
    task.wait(0.8)
    fireproximityprompt(prompt)
end

-- Secure Hold Khusus Auto Repair (6 Detik)
local function secureHoldSupply(prompt)
    if not prompt then return end
    local t = 0
    while (not prompt.Enabled or not prompt.Parent) and t < 50 do
        task.wait(0.1)
        t += 1
    end
    
    -- Simulasi menahan tombol
    prompt:InputHoldBegin()
    task.wait(6.2) -- Durasi hold 6 detik + buffer keamanan
    prompt:InputHoldEnd()
    fireproximityprompt(prompt)
end

-- =========================
-- AUTO REPAIR (SUPPLY)
-- =========================
local function autoRepairCheck()
    local missionUI = PlayerGui:FindFirstChild("BaristaMissionUI")
    local label = missionUI and missionUI:FindFirstChild("ObjectiveLabel", true)
    
    -- Deteksi anomaly (Warna Merah)
    if label and label.TextColor3 == Color3.fromRGB(255, 50, 50) and not isWorking then
        isWorking = true
        print("Anomaly detected. Using Secure Supply Hold...")
        
        voidTween(CFrame.new(supplyPos))
        task.wait(0.5)
        
        local prompt = supplyPart:FindFirstChild("SupplyPrompt")
        if prompt then 
            secureHoldSupply(prompt) 
        end
        
        BaristaEvent:FireServer("RestockSupplies")
        
        task.wait(1)
        voidTween(machinePart.CFrame)
        isWorking = false
    end
end

-- =========================
-- STEALTH MINIGAME LOGIC
-- =========================
local function applyStealthBypass()
    local gui = PlayerGui:FindFirstChild("BaristaGUI")
    local mini = gui and gui:FindFirstChild("MinigameFrame")
    if not mini or not mini.Visible or isWorking then return end

    isWorking = true

    pcall(function()
        local bg = mini:WaitForChild("BackgroundBar")
        local target = bg:WaitForChild("TargetZone")
        target.Size = UDim2.new(1.8, 0, 1.8, 0)
        target.Position = UDim2.new(-0.4, 0, -0.4, 0)
        target.BackgroundTransparency = 1
    end)

    while mini.Visible and _G.AutoFarmBarista do
        task.wait(0.5)
    end

    if not _G.AutoFarmBarista then
        isWorking = false
        return
    end

    local hrp = getHRP()

    TweenService:Create(hrp, TweenInfo.new(0.8), {
        CFrame = registerPart.CFrame + Vector3.new(0, 2, 0)
    }):Play()
    task.wait(0.9)
    smartWaitAndClick(registerPart:WaitForChild("RegisterPrompt"))

    task.wait(1)

    TweenService:Create(hrp, TweenInfo.new(0.8), {
        CFrame = machinePart.CFrame + Vector3.new(0, 2, 0)
    }):Play()

    task.wait(0.9)
    isWorking = false
end

-- =========================
-- MAIN BARISTA CONTROLLER
-- =========================
local function StartBaristaGhost()
    if BaristaRunning then return end
    BaristaRunning = true

    task.spawn(function()
        -- Ganti Tim
        TeamChangeRequest:FireServer("Barista", 11378976, 1, 0, "Detector")
        task.wait(2)

        if not _G.AutoFarmBarista then    
            BaristaRunning = false    
            return    
        end    

        voidTween(startPart.CFrame)    
        smartWaitAndClick(startPart:WaitForChild("JobPrompt"))    
        task.wait(2)    

        voidTween(machinePart.CFrame)    

        while _G.AutoFarmBarista do    
            autoRepairCheck()

            local gui = PlayerGui:FindFirstChild("BaristaGUI")    
            local mini = gui and gui:FindFirstChild("MinigameFrame")    

            if mini and mini.Visible and not isWorking then    
                applyStealthBypass()    
            elseif not isWorking then    
                local hrp = getHRP()    
                if hrp and (hrp.Position - machinePart.Position).Magnitude < 10 then    
                    local prompt = machinePart:FindFirstChild("MachinePrompt")    
                    if prompt and prompt.Enabled then    
                        smartWaitAndClick(prompt)    
                    end    
                end    
            end    

            task.wait(1.5)    
        end    

        BaristaRunning = false
    end)
end

-- =========================
-- SYSTEM LOOPS
-- =========================
task.spawn(function()
    while true do
        task.wait(0.5)
        if _G.AutoFarmBarista then
            StartBaristaGhost()
        end
    end
end)


-- =========================
-- FPS / PING LOOP (FIXED)
-- =========================
task.spawn(function()
    local fpsCounter = 0
    local currentFps = 0

    RunService.Heartbeat:Connect(function()
        fpsCounter += 1
    end)

    while true do
        task.wait(1)

        currentFps = fpsCounter
        fpsCounter = 0

        -- Update FPS
        if FpsLabel then
            FpsLabel:SetDesc(tostring(currentFps) .. " FPS")
        end

        -- Update Ping
        local ping = math.floor(LP:GetNetworkPing() * 1000)
        if PingLabel then
            PingLabel:SetDesc(tostring(ping) .. " ms")
        end
    end
end)
-- // HIDE NAME & CHARACTER LOOP (FIXED)
RunService.Heartbeat:Connect(function()
local char = LP.Character
if not char then return end

-- HIDE NAME
if _G.HideNameEnabled then
local head = char:FindFirstChild("Head")
local tag = head and head:FindFirstChildOfClass("BillboardGui")
if tag then
tag.Enabled = false
end
end

-- HIDE CHARACTER
if _G.HideCharEnabled then
for _, v in pairs(char:GetDescendants()) do
if v:IsA("BasePart") then
v.Transparency = 1
v.CanCollide = false
elseif v:IsA("Decal") then
v.Transparency = 1
end
end
end

end)

-- ANTI AFK FIXED
task.spawn(function()
    local VU = game:GetService("VirtualUser")
    while task.wait(60) do
        if _G.AntiAFK then
            VU:CaptureController()
            VU:ClickButton2(Vector2.new(0,0))
        end
    end
end)

